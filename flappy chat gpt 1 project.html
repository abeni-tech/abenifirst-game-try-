<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Flappy Levels</title>
<style>
body{margin:0;font-family:Arial;background:#dff6ff;display:flex;justify-content:center;padding:20px}
#gameWrap{width:480px;max-width:95vw}
canvas{width:100%;background:#8fd9ff;border-radius:10px}
#menu,#gameOver{background:#fff;padding:20px;border-radius:10px;box-shadow:0 4px 20px rgba(0,0,0,0.1);text-align:center;margin-top:10px}
.btn{padding:10px 16px;margin:6px;border:none;border-radius:6px;font-weight:bold;cursor:pointer}
.primary{background:#1874a9;color:#fff}
.ghost{background:#eee}
</style>
</head>
<body>
<div id="gameWrap">
<canvas id="game" width="480" height="640"></canvas>
<div id="menu">
<h2>Flappy — Levels</h2>
<button class="btn primary" id="lv1">Level 1 — Very Easy</button><br>
<button class="btn primary" id="lv2">Level 2 — Medium</button><br>
<button class="btn primary" id="lv3">Level 3 — Normal</button>
<p>High Score: <strong id="hs">0</strong></p>
</div>
<div id="gameOver" style="display:none"></div>
</div>
<script>
const canvas=document.getElementById('game');
const ctx=canvas.getContext('2d');
let level=1;
let running=false;
let score=0;
let highScore=0;
let pipes=[];
let pipeTimer=0;
const bird={x:90,y:300,radius:12,vel:0,gravity:0.22,jumpPower:-6};
const config={pipeWidth:55,gap1:180,gap2:150,gap3:130,speed1:1.3,speed2:1.6,speed3:2,spawn:1500};
function applyLevel(){
 if(level===1){bird.gravity=0.22;config.pipeSpeed=config.speed1;config.gap=config.gap1;}
 if(level===2){bird.gravity=0.30;config.pipeSpeed=config.speed2;config.gap=config.gap2;}
 if(level===3){bird.gravity=0.38;config.pipeSpeed=config.speed3;config.gap=config.gap3;}
}
function reset(){score=0;pipes=[];pipeTimer=0;bird.y=300;bird.vel=0;applyLevel();}
function spawnPipe(){let topH=Math.random()*(canvas.height-config.gap-120)+60;pipes.push({x:canvas.width,top:topH,bottom:topH+config.gap});}
function flap(){if(!running)return;bird.vel=bird.jumpPower;}
function collide(p){let bx=bird.x,by=bird.y,r=bird.radius;if(bx+r>p.x&&bx-r<p.x+config.pipeWidth){if(by-r<p.top||by+r>p.bottom)return true;}if(by+r>canvas.height||by-r<0)return true;return false;}
function draw(){ctx.clearRect(0,0,canvas.width,canvas.height);ctx.fillStyle="#2b9348";pipes.forEach(p=>{ctx.fillRect(p.x,0,config.pipeWidth,p.top);ctx.fillRect(p.x,p.bottom,config.pipeWidth,canvas.height-p.bottom);});ctx.fillStyle="#ffb703";ctx.beginPath();ctx.arc(bird.x,bird.y,bird.radius,0,Math.PI*2);ctx.fill();}
let last=0;
function loop(ts){if(!last)last=ts;let dt=ts-last;last=ts;if(running){bird.vel+=bird.gravity;bird.y+=bird.vel;pipes.forEach(p=>p.x-=config.pipeSpeed);if(pipes.length&&pipes[0].x+config.pipeWidth<0)pipes.shift();pipeTimer+=dt;if(pipeTimer>config.spawn){spawnPipe();pipeTimer=0;}pipes.forEach(p=>{if(!p.passed&&p.x+config.pipeWidth<bird.x){p.passed=true;score++;}});for(let p of pipes){if(collide(p)){endGame();return;}}}
draw();if(running)requestAnimationFrame(loop);}
function endGame(){running=false;highScore=Math.max(highScore,score);document.getElementById('hs').innerText=highScore;let go=document.getElementById('gameOver');go.style.display='block';go.innerHTML=`<h2>Game Over</h2><p>Score: ${score}</p><button class='btn primary' id='again'>Play Again</button>`;document.getElementById('menu').style.display='block';document.getElementById('again').onclick=()=>start();}
function start(){reset();running=true;document.getElementById('menu').style.display='none';document.getElementById('gameOver').style.display='none';last=0;requestAnimationFrame(loop);}
// Level buttons
lv1.onclick=()=>{level=1;start();};
lv2.onclick=()=>{level=2;start();};
lv3.onclick=()=>{level=3;start();};
window.addEventListener('keydown',e=>{if(e.code==='Space')flap();});
canvas.addEventListener('pointerdown',flap);
</script>
</body>
</html>
